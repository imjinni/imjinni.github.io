---
layout: single
title: "[Git Page로 Blog 만들기] - [11] Fixed Topbar 만들기"
post-order: 11
date: "2020-12-07 17:17:00 +0900"
last_modified_at: "2020-12-07 22:57:00 +0900"
urls:
  fixed-topbar: "/front-end/fixed_topbar/"
---
내 블로그의 Topbar와 같이 화면을 스크롤 해도 항상 그 자리에 고정돼 있는 Topbar를 구현하자.
내 블로그의 Fixed Topbar는 [Fixed Topbar 구현][Fixed Topbar 구현] 포스트의
[방법2]({{ site.baseurl }}{{ page.urls.fixed-topbar }}#구현-method-2) 를 바탕으로 제작되었다.
이 포스트에서는 같은 방법을 Minimal-Mistakes 테마에 적용하는 과정을 포스팅 할 것이다.

## 과정

과정을 진행하면서 Topbar를 페이지 최상위에 고정 시키고
[Fixed Topbar 구현][Fixed Topbar 구현] 포스트에서 제기했던
[HTML 요소가 가려지는 문제]({{ site.baseurl }}{{ page.urls.fixed-topbar }}#문제점-fixed-topbar가-내용을-가림)를
해결할 것이다.

### 1. Topbar 고정

mmistakes 테마에서 Topbar를 페이지 최상위에 고정시키기위해 아래와 같은 CSS 를 적용한다.

```css
.masthead {
    position: fixed;
    top: 0;
    height: calc(3 * 16px);
    width: 100%;
}
```

Topbar의 높이인 `calc(3 * 16px);`는 48px가 된다.

### 2. 내용 여백 조정

Fixed Topbar로 인해 포스트 내용이 가려지는 것을 방지하기 위해 내용이 약간 아래부터 시작하도록 윗쪽 여백을 넣는다.

```css
body {
    padding-top: calc(3 * 16px + 8px);
}
```

Fixed Topbar의 높이(`3*16px=48px`)에 `+8px` 만큼의 여백을 더 추가하였다.

### 3. Javascript 작성

위 두가지 css 설정으로 해결 되지 않는 문제들을 javascript를 이용해서 마무리한다.

[Fixed Topbar 구현][Fixed Topbar 구현] 포스트에서 제기한
[문제 상황 2]({{ site.baseurl }}{{ page.urls.fixed-topbar }}#문제-상황-2),
[3]({{ site.baseurl }}{{ page.urls.fixed-topbar }}#문제-상황-3)이 여기에 해당한다.

먼저 페이지를 스크롤하는 함수를 정의한다.

```javascript
top_offset = 99;
function scrollToHash(h) {
    var yPos = $(h).offset().top - top_offset;  // 스크롤 위치를 맨꼭대기가 아닌 top_offset 만큼 아래로 계산
    scrollTo({top: yPos, behavior: 'smooth'});
}
```

이때 `top_offset`이라는 변수를 정의해서 자동 스크롤을 하면 브라우저 화면 맨 꼭대기로 부터
`top_offset` 픽셀 만큼 아래의 y좌표 위치로 스크롤 되도록 한다.<br/>
또한 `scrollTo()`(스크롤 함수)에 `behavior: 'smooth'` 옵션을 넣어서 부드러운 스크롤링을 설정했다.<br/>
<span class="md-monologue">참고로 Windows OS에서 부드러운 스크롤링은&nbsp;
`Windows에서 애니메이션 표시` 옵션을 켜야 정상적으로 동작 한다.</span>

* 다른 페이지로 부터 이동해 온 다음 특정 위치로 자동 스크롤 할 때

다른 페이지에서 링크를 클릭하면 링크의 `href` 경로로 페이지 이동한다.
이때 `href`에 `hash`가 있으면 브라우저는 페이지 이동한 후 해당 위치로 화면을 자동 스크롤 한다.

```javascript
$(function() {
    if(location.hash.length > 0) {
        var h = decodeURIComponent(location.hash);
        scrollToHash(h);
    }
});
```

`$(function(){})` 코드는 jquery에서 지원하는 함수이며 페이지의 로드가 완료되면 실행되는 함수이다.<br/>
이 함수를 이용해서 페이지 로드가 완료되면 현재 URL에 `hash`가 포함되어 있는지 확인하고
`hash`가 포함돼 있다면 해당 위치로 이동하는 코드를 실행하도록 한다.

* 같은 페이지 내에서 다른 위치로 자동 스크롤 할 때

#### Javascript 전체 코드

위 코드 조각들을 한번에 쓰면 아래와 같다.

```javascript
$(function() {
    top_offset = 99;
    function scrollToHash(h) {
        var yPos = $(h).offset().top - top_offset;
        scrollTo({top: yPos, behavior: 'smooth'});
    }
    // 외부 페이지로부터 이동해 온 후 다른 위치로 스크롤 할 때
    if(location.hash.length > 0) {
        var h = decodeURIComponent(location.hash);
        scrollToHash(h);
    }
    // 같은 페이지에서 다른 위치로 스크롤 할 때
    $('a').click(function (e) {
        if($(this)[0].origin == location.origin &&
           $(this)[0].pathname == location.pathname) {
            e.preventDefault();
            var h = $(this).attr('href');
            scrollToHash(h);
            history.pushState({}, null, h);
        }
    });
});
```

[Fixed Topbar 구현]: {{ site.baseurl }}{{ page.urls.fixed-topbar }}
